
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://salvasevero.github.io/ciber/15_Ataque_PPTP.html">
      
      
        <link rel="prev" href="9_EnrutamientoDinamico.html">
      
      
        <link rel="next" href="11_VLANs.html">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Ataque PPTP - CiberSeguridad Redes.</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="stylesheets/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#atacar-servidor-vpn-pptp-mschapv2" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="." title="CiberSeguridad Redes." class="md-header__button md-logo" aria-label="CiberSeguridad Redes." data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            CiberSeguridad Redes.
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Ataque PPTP
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo día"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Cambiar a modo día" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Cambiar a modo noche"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Cambiar a modo noche" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="CiberSeguridad Redes." class="md-nav__button md-logo" aria-label="CiberSeguridad Redes." data-md-component="logo">
      
  <img src="imagenes/logofp.png" alt="logo">

    </a>
    CiberSeguridad Redes.
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    WARM UP
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            WARM UP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="0_Modelo_Capas.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Modelo Capas
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="1_ConocimientosBasicos.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conocimientos Básicos L2
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="3_CAM_Overflow.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PoC CAM Overflow
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="4_ConocimientosL3.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conocimientos Básicos L3
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="5_TeoriaVLAN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Teoría VLAN
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="6_DHCP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    DHCP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="7_ConceptosL4.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conceptos Básicos L4
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="8_NAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    NAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="9_EnrutamientoDinamico.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Enrutamiento Dinámico
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    OFENSIVA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            OFENSIVA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Ataque PPTP
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="15_Ataque_PPTP.html" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Ataque PPTP
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#fingerprint" class="md-nav__link">
    <span class="md-ellipsis">
      Fingerprint.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diccionarios" class="md-nav__link">
    <span class="md-ellipsis">
      Diccionarios.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#comandos" class="md-nav__link">
    <span class="md-ellipsis">
      Comandos.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#mitm-man-in-the-middle" class="md-nav__link">
    <span class="md-ellipsis">
      MITM (Man In The Middle)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#analizar-trafico-capturado" class="md-nav__link">
    <span class="md-ellipsis">
      Analizar tráfico capturado.
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ataque-por-diccionario" class="md-nav__link">
    <span class="md-ellipsis">
      Ataque por diccionario.
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    DEFENSIVA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            DEFENSIVA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="11_VLANs.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VLANs
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="10_LACP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    STACK & LACP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="12_VRRP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    VRRP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    VPN
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            VPN
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="13_VPN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conceptos Básicos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="14_PPTP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="17_IPSec.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IPSec
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="16_OpenVPN.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OpenVPN & Wireguard
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    ANEXO
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            ANEXO
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_ProblemasEVE.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Problemas Simulador
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Comandos Cisco
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Comandos Cisco
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="2_ComandosCisco.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comandos Básicos
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_ComandosCisco2.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comandos Router
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_ComandosNAT.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comandos NAT
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_CiscoACL.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ACL
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Configuraciones Mikrotik
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Configuraciones Mikrotik
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_Configuraci%C3%B3nMikrotik.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Configuración Básica
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_Configurar_PPTP.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PPTP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_IPSec.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    L2TP/IPSec
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="A_Usuarios.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usuarios EVE-NG
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div><h1 id="atacar-servidor-vpn-pptp-mschapv2">Atacar servidor VPN PPTP MSCHAPv2.<a class="headerlink" href="#atacar-servidor-vpn-pptp-mschapv2" title="Permanent link">¶</a></h1>
<h2 id="fingerprint">Fingerprint.<a class="headerlink" href="#fingerprint" title="Permanent link">¶</a></h2>
<p>En primer lugar vamos a recoger información del servidor (fingerprint).</p>
<div class="highlight"><pre><span></span><code>nmap -Pn -sSV -p1723 [IP SERVIDOR]
</code></pre></div>
<p>Podemos ver el puerto que está abierto usando PPTP, además de que es un Mikrotik con firmware 1.</p>
<center>
<figure>
  <img src="imagenes/ofensiva/1.png" width="700">
</figure>
</center>

<h2 id="diccionarios">Diccionarios.<a class="headerlink" href="#diccionarios" title="Permanent link">¶</a></h2>
<p>Durante el ataque habrá un momento que haremos un ataque por diccionario. </p>
<p>Para ello tenemos <ins class="critic">varias opciones</ins>:</p>
<p>En el directorio <mark class="critic">/usr/share/wordlists</mark> de nuestro Kali tenemos la lista de palabras de diccionario.</p>
<ol>
<li>
<p><strong>“rockyou”</strong> es una de las más famosas, simplemente contiene palabras típicas que se suelen usar como contraseña. Se puede descomprimir con <ins class="critic">“gunzip rock….”</ins>.</p>
<p></p><center>
<figure>
<img src="imagenes/ofensiva/2.png" width="700">
</figure>
</center>
<p></p><center>
<figure>
<img src="imagenes/ofensiva/3.png" width="700">
</figure>
</center>
</li>
<li>
<p>También podemos hacer uso de la lista <strong>“darkc0de”.</strong> u otros diccionarios de referencia.</p>
<div class="highlight"><pre><span></span><code>wget https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/darkc0de.txt

wget https://github.com/danielmiessler/SecLists/blob/master/Passwords/openwall.net-all.txt

wget https://github.com/danielmiessler/SecLists/raw/master/Passwords/Software/john-the-ripper.txt
</code></pre></div>
</li>
<li>
<p>En caso de no existir la ruta /usr/share/wordlists podemos hacer:</p>
<div class="highlight"><pre><span></span><code>sudo apt install wordlists –-reinstall
</code></pre></div>
</li>
</ol>
<h2 id="comandos">Comandos.<a class="headerlink" href="#comandos" title="Permanent link">¶</a></h2>
<p>Vamos a trabajar con 3 comandos:</p>
<p><strong>genkeys</strong>: Para generar e indexar claves hash a partir de una lista de palabras, que luego nos permitirá comparar con las claves hash que capturemos.</p>
<p><strong>asleap</strong>: Permite, a partir de los códigos “challenge” y “response” del protocolo MSCHAP compararlos con los diferentes hash de nuestro índice, generados por genkeys a partir de las palabras de diccionario. También te permite pasarle una captura de paquetes, por ejemplo de wireshark, y que él te sustraiga los elementos necesarios.</p>
<p><strong>thc-pptp-bruter</strong>: Permite, a partir de la IP del firewall y del nombre de usuario, romper la clave por fuerza bruta en caso de que el ataque por diccionario no funcione, aunque también se le puede pasar una lista de palabras al comando.</p>
<center>
<figure>
<img src="imagenes/ofensiva/4.png" width="900">
</figure>
</center>

<center>
<figure>
<img src="imagenes/ofensiva/5.png" width="900">
</figure>
</center>

<h2 id="mitm-man-in-the-middle">MITM (Man In The Middle)<a class="headerlink" href="#mitm-man-in-the-middle" title="Permanent link">¶</a></h2>
<ul>
<li>
<p>Para realizar el ataque MITM (Man In The Middle) ARP Poisoning haremos uso de la aplicación <mark class="critic">“Ettercap” (ver manual Ettercap)</mark>. </p>
</li>
<li>
<p>El ARP Poisoning nos permitirá hacernos pasar por el servidor VPN y a su vez hacernos pasar por la víctima, interceptando así todo el tráfico entre ellos. </p>
</li>
<li>
<p>Una vez capturado, el tráfico se reenviará al destinatario (servidor/cliente) correcto para que siga habiendo comunicación entre ellos y podamos seguir capturando el resto de la conversación.</p>
</li>
</ul>
<h2 id="analizar-trafico-capturado">Analizar tráfico capturado.<a class="headerlink" href="#analizar-trafico-capturado" title="Permanent link">¶</a></h2>
<p>Una vez realizado el MITM analizaremos con <mark class="critic">Wireshark</mark> el tráfico capturado.</p>
<h3 id="nombre-de-usuario">Nombre de usuario.<a class="headerlink" href="#nombre-de-usuario" title="Permanent link">¶</a></h3>
<p>Primero filtraremos por el protocolo <ins class="critic">“chap”</ins>, que es el protocolo de seguridad que usa PPTP.</p>
<center>
<figure>
<img src="imagenes/ofensiva/6.png" width="900">
</figure>
</center>

<p>Como se puede comprobar en la captura anterior, <ins class="critic">el nombre de usuario viaja en texto plano</ins>.</p>
<div class="admonition warning">
<p class="admonition-title">Ataque Fuerza Bruta</p>
<p>A partir de aquí podemos intentar solventarlo sabiendo el usuario y la IP del servidor por fuerza bruta, pero es un <mark class="critic">proceso mucho más lento</mark>.</p>
<div class="highlight"><pre><span></span><code>cat darkc0de.txt | thc-pptp-bruter –u [Nombre_Usuario] [IP_Servidor]
</code></pre></div>
<p></p><center>
<figure>
<img src="imagenes/ofensiva/7.png" width="900">
</figure>
</center>
<p>No obstante vamos, primero a probar un ataque por diccionario, para que en caso de que sea una contraseña “sencilla” podamos romperla de forma rápida.</p>
</div>
<h3 id="challenge-y-response">Challenge y Response.<a class="headerlink" href="#challenge-y-response" title="Permanent link">¶</a></h3>
<p>A parte del usuario, podemos sacar información del código hash del “Challenge” y del “Response” del protocolo MSCHAPv2.</p>
<p><mark class="critic">Para copiar datos dentro de wireshark es preferible darle a botón derecho – Copiar – Hex Stream.</mark></p>
<center>
<figure>
<img src="imagenes/ofensiva/8.png" width="900">
</figure>
</center>

<center>
<figure>
<img src="imagenes/ofensiva/9.png" width="900">
</figure>
</center>

<h2 id="ataque-por-diccionario">Ataque por diccionario.<a class="headerlink" href="#ataque-por-diccionario" title="Permanent link">¶</a></h2>
<p>A continuación nos bajamos el script "chap2asleap" que hará uso de los comandos <ins class="critic">“asleap” y “genkeys”</ins> para romper la seguridad.</p>
<div class="admonition tip">
<p class="admonition-title">chap2asleap</p>
<p>Se debería de encontrar en el <mark class="critic">Escritorio del Kali</mark> o se puede descargar.</p>
<div class="highlight"><pre><span></span><code>git clone https://github.com/xiao106347/chap2asleap.git
</code></pre></div>
</div>
<p>Ejecutamos el script  de python con la siguiente información:</p>
<div class="center-table">
<table>
<thead>
<tr>
<th style="text-align: center;">Comando</th>
<th style="text-align: center;"><center> Función </center></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>–u</code></td>
<td style="text-align: center;">Usuario</td>
</tr>
<tr>
<td style="text-align: center;"><code>–c Challenge</code></td>
<td style="text-align: center;">Sacado del wireshark en hexadecimal.</td>
</tr>
<tr>
<td style="text-align: center;"><code>–r Response</code></td>
<td style="text-align: center;">Sacado del wireshark en hexadecimal.</td>
</tr>
<tr>
<td style="text-align: center;"><code>-x</code></td>
<td style="text-align: center;">Para que ejecute todo el proceso.</td>
</tr>
<tr>
<td style="text-align: center;"><code>–p</code></td>
<td style="text-align: center;">La ruta donde se encuentra el comando asleap.</td>
</tr>
<tr>
<td style="text-align: center;"><code>-d</code></td>
<td style="text-align: center;">La ruta donde se encuentra la lista de diccionario. El propio script se ocupa de indexarlo en claves hash mediante genkeys.</td>
</tr>
<tr>
<td style="text-align: center;"><code>-v</code></td>
<td style="text-align: center;">Para que te vaya sacando información del proceso que va realizando.</td>
</tr>
</tbody>
</table>
</div>
<center>
<figure>
<img src="imagenes/ofensiva/10.png" width="900">
</figure>
</center>

<div class="admonition warning">
<p class="admonition-title">Contraseña Robusta</p>
<p>En el caso de que la contraseña fuese más compleja, por ejemplo, “A#i4-…”, el ataque por diccionario no funcionaría y deberíamos usar el ataque por fuerza bruta.</p>
</div></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Salvador Serrano Pérez - Licencia CC BY-NC-SA
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": ".", "features": ["header.autohide", "toc.integrate", "navigation.indexes", "content.code.copy"], "search": "assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.56ea9cef.min.js"></script>
      
    
  </body>
</html>